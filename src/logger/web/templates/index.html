{% extends "base.html" %}

{% block title %}æ—¶é—´çº¿ - ç”Ÿæ´»æ—¥å¿—{% endblock %}

{% block content %}
<div class="page-header">
    <h2>ğŸ“… æ—¥å¿—æ—¶é—´çº¿</h2>
    <p class="subtitle">è®°å½•ä½ çš„æ¯ä¸€åˆ»</p>
</div>

<div class="filters">
    <form method="get" action="/" class="filter-form">
        <div class="filter-group">
            <label for="category">åˆ†ç±»ï¼š</label>
            <select name="category" id="category">
                <option value="">å…¨éƒ¨</option>
                {% for cat in categories %}
                <option value="{{ cat }}" {% if cat == selected_category %}selected{% endif %}>{{ cat }}</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="filter-group">
            <label for="start_date">å¼€å§‹æ—¥æœŸï¼š</label>
            <input type="date" name="start_date" id="start_date" value="{{ start_date or '' }}">
        </div>
        
        <div class="filter-group">
            <label for="end_date">ç»“æŸæ—¥æœŸï¼š</label>
            <input type="date" name="end_date" id="end_date" value="{{ end_date or '' }}">
        </div>
        
        <button type="submit" class="btn btn-primary">ç­›é€‰</button>
        <a href="/" class="btn btn-secondary">é‡ç½®</a>
    </form>
</div>

<div class="logs-container">
    {% if logs %}
        {% for log in logs %}
        <div class="log-card">
            <div class="log-header">
                <span class="log-id">#{{ log.id }}</span>
                <span class="log-category category-{{ log.category }}">{{ log.category }}</span>
                <span class="log-time">{{ log.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</span>
            </div>
            
            <div class="log-body">
                <h3 class="log-summary">{{ log.ai_summary }}</h3>
                
                {% if log.original_text %}
                <div class="log-original">
                    <strong>åŸæ–‡ï¼š</strong>
                    <p>{{ log.original_text[:300] }}{% if log.original_text|length > 300 %}...{% endif %}</p>
                </div>
                {% endif %}
                
                {% if log.image_path %}
                <div class="log-image">
                    <span class="image-indicator">ğŸ–¼ï¸ åŒ…å«å›¾ç‰‡</span>
                </div>
                {% endif %}
            </div>
            
            <div class="log-footer">
                {% if log.tags %}
                <div class="log-tags">
                    {% for tag in log.tags %}
                    <span class="tag">{{ tag }}</span>
                    {% endfor %}
                </div>
                {% endif %}
                
                {% if log.duration_estimate %}
                <div class="log-duration">
                    â± {{ log.duration_estimate }} åˆ†é’Ÿ
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="empty-state">
            <p>ğŸ˜Š è¿˜æ²¡æœ‰æ—¥å¿—è®°å½•</p>
            <p class="hint">ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·æ·»åŠ ä½ çš„ç¬¬ä¸€æ¡æ—¥å¿—ï¼š<code>logger add</code></p>
        </div>
    {% endif %}
</div>

{% if logs|length >= 50 %}
<div class="pagination-hint">
    <p>ğŸ’¡ æç¤ºï¼šä½¿ç”¨ç­›é€‰åŠŸèƒ½æŸ¥çœ‹æ›´å¤šæ—¥å¿—</p>
</div>
{% endif %}
{% endblock %}


